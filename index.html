<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>USB Tester</title>
  <link rel="stylesheet" href="css/styles.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <div class="container">
    <header>
      <h1>USB Tester</h1>
      <div class="controls">
        <button id="connectBtn">Connect</button>
        <button id="connectEmulatorBtn">Connect Emulator</button>
        <button id="reconnectBtn" disabled>Reconnect</button>
        <button id="disconnectBtn" disabled>Disconnect</button>
        <button id="resetCountersBtn" disabled>Reset Counters</button>
      </div>
    </header>
    <div class="disposable-section">
      <button class="remove-btn">âœ–</button>
      <div class="section-content">
        <h2>USB Tester Dashboard</h2>
        <div class="intro-grid">
          <div class="intro-text">
            <p>This dashboard connects to your <strong>USB Tester device</strong> via Bluetooth to visualize and analyze power data in real-time. Monitor voltage (V), current (A), power (W), and energy consumption (Ah/Wh) through interactive charts.</p>
            
            <h3>How to Use:</h3>
            <ol>
              <li>Click <strong>Connect</strong> to pair with your USB Tester</li>
              <li>Select your device from the Bluetooth list</li>
              <li>View live data in the charts below</li>
              <li>Use <strong>Save to CSV</strong> to export measurements</li>
            </ol>

            <h3>Source code</h3>
            <ol>
              <a href="https://github.com/hpirila/usb-tester">https://github.com/hpirila/usb-tester</a>
            </ol>
            <p class="tip">ðŸ’¡ <em>No device? Test with <strong>Connect Emulator</strong> to simulate data!</em></p>
           
            <a href="https://s.click.aliexpress.com/e/_oF8CCmf" class="purchase-btn" target="_blank">Buy USB Tester</a>
          </div>
          <div class="device-image">
            <img src="images/image.jpg" alt="USB Tester Device" width="300">
          </div>
        </div>
      </div>
    </div>
    <script>
      document.querySelector('.remove-btn').addEventListener('click', function() {
        this.parentElement.remove();
      });
    </script>
    <div class="no-bluetooth-card" id="noBluetoothCard" style="display: none;">
      <div class="card-content">
        <h2>Bluetooth Not Supported</h2>
        <p>Your browser does not support Web Bluetooth. Please use a compatible browser like Google Chrome or Microsoft
          Edge to connect to a USB Tester device.</p>
        <p>You can still use the emulator mode by clicking "Connect Emulator".</p>
        <button id="closeCardBtn">Close</button>
      </div>
    </div>
    <div class="graph-grid">
      <div class="chart-wrapper" id="chart-0-wrapper">
        <button class="remove-btn" data-chart="chart-0">âœ–</button>
        <button class="expand-btn" data-chart="chart-0">ðŸ¡•</button>
        <button class="collapse-btn" data-chart="chart-0">ðŸ¡—</button>
        <canvas id="chart-0"></canvas>
        <div class="chart-controls">
          <div class="checkboxes">
            <label><input type="checkbox" id="chart-0-v" checked>V</label>
            <label><input type="checkbox" id="chart-0-a" checked>A</label>
            <label><input type="checkbox" id="chart-0-w" checked>W</label>
            <label><input type="checkbox" id="chart-0-usbMinus">USB-</label>
            <label><input type="checkbox" id="chart-0-usbPlus">USB+</label>
            <label><input type="checkbox" id="chart-0-ah" checked>Ah</label>
            <label><input type="checkbox" id="chart-0-wh" checked>Wh</label>
          </div>
          <div class="save-controls">
            <button class="save-btn save-chart-btn" data-chart="chart-0">Save</button>
            <input type="text" class="chart-filename" value="VAWAhWh.png">
          </div>
        </div>
      </div>
      <div class="chart-wrapper" id="chart-1-wrapper">
        <button class="remove-btn" data-chart="chart-1">âœ–</button>
        <button class="expand-btn" data-chart="chart-1">ðŸ¡•</button>
        <button class="collapse-btn" data-chart="chart-1">ðŸ¡—</button>
        <canvas id="chart-1"></canvas>
        <div class="chart-controls">
          <div class="checkboxes">
            <label><input type="checkbox" id="chart-1-v" checked>V</label>
            <label><input type="checkbox" id="chart-1-a">A</label>
            <label><input type="checkbox" id="chart-1-w">W</label>
            <label><input type="checkbox" id="chart-1-usbMinus">USB-</label>
            <label><input type="checkbox" id="chart-1-usbPlus">USB+</label>
            <label><input type="checkbox" id="chart-1-ah">Ah</label>
            <label><input type="checkbox" id="chart-1-wh">Wh</label>
          </div>
          <div class="save-controls">
            <button class="save-btn save-chart-btn" data-chart="chart-1">Save</button>
            <input type="text" class="chart-filename" value="V.png">
          </div>
        </div>
      </div>
    </div>
    <div class="add-chart">
      <button id="addChartBtn">Add Chart</button>
    </div>
    <div class="csv-data">
      <div class="csv-header">V A W Ah Wh D- D+ T t Raw</div>
      <div id="debugOutput"></div>
      <div class="save-controls">
        <button class="save-btn" id="saveCsvBtn">Save to CSV</button>
        <input type="text" id="csvFilename" value="USB_Tester.csv">
      </div>
    </div>
    <div class="status-log">
      <div id="statusOutput"></div>
    </div>
    <footer>
      <p>USB Tester v1.0 Â© 2025</p>
    </footer>
  </div>
  <script src="js/chart.js"></script>
  <script src="js/logging.js"></script>
  <script src="js/main.js"></script>
</body>

</html>